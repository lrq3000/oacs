<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>OACS: C:/oacs/oacs/oacs/lib/debug/runsnakerun/pstatsloader.py Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">OACS
   </div>
   <div id="projectbrief">Server-side anti-cheat system for online games</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('pstatsloader_8py_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Properties</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">pstatsloader.py</div>  </div>
</div><!--header-->
<div class="contents">
<a href="pstatsloader_8py.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno"><a class="code" href="namespaceoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader.html">    1</a></span>&#160;<span class="stringliteral">&quot;&quot;&quot;Module to load cProfile/profile records as a tree of records&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="keyword">import</span> pstats, os, logging</div>
<div class="line"><a name="l00003"></a><span class="lineno"><a class="code" href="namespaceoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader.html#abe1ff1fd5b804114d0f45cdbc6f161f2">    3</a></span>&#160;log = logging.getLogger(__name__)</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">#log.setLevel( logging.DEBUG )</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="keyword">from</span> gettext <span class="keyword">import</span> gettext <span class="keyword">as</span> _</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;TREE_CALLS, TREE_FILES = range( 2 )</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;</div>
<div class="line"><a name="l00009"></a><span class="lineno"><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stats_loader.html">    9</a></span>&#160;<span class="keyword">class </span><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stats_loader.html">PStatsLoader</a>( object ):</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;Load profiler statistic from &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno"><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stats_loader.html#a3160082c03abcb26ff6686f4b5ab7fd1">   11</a></span>&#160;    <span class="keyword">def </span><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stats_loader.html#a3160082c03abcb26ff6686f4b5ab7fd1">__init__</a>( self, *filenames ):</div>
<div class="line"><a name="l00012"></a><span class="lineno"><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stats_loader.html#abcbb9adf4eae60d90d6f6590c09d7124">   12</a></span>&#160;        self.<a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stats_loader.html#abcbb9adf4eae60d90d6f6590c09d7124">filename</a> = filenames</div>
<div class="line"><a name="l00013"></a><span class="lineno"><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stats_loader.html#a27a0b40129d28e99571a4fb3c9e7cba9">   13</a></span>&#160;        self.<a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stats_loader.html#a27a0b40129d28e99571a4fb3c9e7cba9">rows</a> = {}</div>
<div class="line"><a name="l00014"></a><span class="lineno"><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stats_loader.html#ad6cf1512b764dd8cd4a8a7106a4115c3">   14</a></span>&#160;        self.<a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stats_loader.html#ad6cf1512b764dd8cd4a8a7106a4115c3">stats</a> = pstats.Stats( *filenames )</div>
<div class="line"><a name="l00015"></a><span class="lineno"><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stats_loader.html#ab0190db9b2cb1d20a6040f49fa911727">   15</a></span>&#160;        self.<a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stats_loader.html#ab0190db9b2cb1d20a6040f49fa911727">tree</a> = self.<a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stats_loader.html#a2fcd04bda81d3184b3b756a7fc8baec5">load</a>( self.stats.stats )</div>
<div class="line"><a name="l00016"></a><span class="lineno"><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stats_loader.html#a2f9e43fe197653f83fa0e15c676eec48">   16</a></span>&#160;        self.<a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stats_loader.html#a2f9e43fe197653f83fa0e15c676eec48">location_rows</a> = {}</div>
<div class="line"><a name="l00017"></a><span class="lineno"><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stats_loader.html#a5124ee0392c7d0e565af9f7d55e77b61">   17</a></span>&#160;        self.<a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stats_loader.html#a5124ee0392c7d0e565af9f7d55e77b61">location_tree</a> = l = self.<a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stats_loader.html#a1679487cba49f571a8ba9a77d461e20d">load_location</a>( )</div>
<div class="line"><a name="l00018"></a><span class="lineno"><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stats_loader.html#a2fcd04bda81d3184b3b756a7fc8baec5">   18</a></span>&#160;    <span class="keyword">def </span><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stats_loader.html#a2fcd04bda81d3184b3b756a7fc8baec5">load</a>( self, stats ):</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;Build a squaremap-compatible model from a pstats class&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;        rows = self.<a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stats_loader.html#a27a0b40129d28e99571a4fb3c9e7cba9">rows</a></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;        <span class="keywordflow">for</span> func, raw <span class="keywordflow">in</span> stats.iteritems():</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;            <span class="keywordflow">try</span>:</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;                rows[func] = row = <a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_row.html">PStatRow</a>( func,raw )</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;            <span class="keywordflow">except</span> ValueError, err:</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;                log.info( <span class="stringliteral">&#39;Null row: %s&#39;</span>, func )</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;        <span class="keywordflow">for</span> row <span class="keywordflow">in</span> rows.itervalues():</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;            row.weave( rows )</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        <span class="keywordflow">return</span> self.<a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stats_loader.html#a49bb494cff8279bc27af8e28b0d52d08">find_root</a>( rows )</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div>
<div class="line"><a name="l00030"></a><span class="lineno"><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stats_loader.html#a49bb494cff8279bc27af8e28b0d52d08">   30</a></span>&#160;    <span class="keyword">def </span><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stats_loader.html#a49bb494cff8279bc27af8e28b0d52d08">find_root</a>( self, rows ):</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;Attempt to find/create a reasonable root node from list/set of rows</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="stringliteral">        rows -- key: PStatRow mapping</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="stringliteral">        TODO: still need more robustness here, particularly in the case of</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="stringliteral">        threaded programs.  Should be tracing back each row to root, breaking</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="stringliteral">        cycles by sorting on cummulative time, and then collecting the traced</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="stringliteral">        roots (or, if they are all on the same root, use that).</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        maxes = <a class="code" href="namespaceoacs_1_1lib_1_1argparse.html#a6d5cd9ed2e6548d3679d1752e6da1ea1">sorted</a>( rows.values(), key = <span class="keyword">lambda</span> x: x.cummulative )</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        <span class="keywordflow">if</span> <span class="keywordflow">not</span> maxes:</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;            <span class="keywordflow">raise</span> RuntimeError( <span class="stringliteral">&quot;&quot;&quot;Null results!&quot;&quot;&quot;</span> )</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        root = maxes[-1]</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        roots = [root]</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        <span class="keywordflow">for</span> key,value <span class="keywordflow">in</span> rows.items():</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;            <span class="keywordflow">if</span> <span class="keywordflow">not</span> value.parents:</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                log.debug( <span class="stringliteral">&#39;Found node root: %s&#39;</span>, value )</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;                <span class="keywordflow">if</span> value <span class="keywordflow">not</span> <span class="keywordflow">in</span> roots:</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;                    roots.append( value )</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        <span class="keywordflow">if</span> len(roots) &gt; 1:</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;            root = <a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_group.html">PStatGroup</a>(</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;                directory=<span class="stringliteral">&#39;*&#39;</span>,</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                filename=<span class="stringliteral">&#39;*&#39;</span>,</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                name=_(<span class="stringliteral">&quot;&lt;profiling run&gt;&quot;</span>),</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                children= roots,</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;            )</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;            root.finalize()</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;            self.<a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stats_loader.html#a27a0b40129d28e99571a4fb3c9e7cba9">rows</a>[ root.key ] = root</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <span class="keywordflow">return</span> root</div>
<div class="line"><a name="l00060"></a><span class="lineno"><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stats_loader.html#a1679487cba49f571a8ba9a77d461e20d">   60</a></span>&#160;    <span class="keyword">def </span><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stats_loader.html#a1679487cba49f571a8ba9a77d461e20d">load_location</a>( self ):</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;Build a squaremap-compatible model for location-based hierarchy&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        directories = {}</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        files = {}</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        root = <a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_location.html">PStatLocation</a>( <span class="stringliteral">&#39;/&#39;</span>, <span class="stringliteral">&#39;PYTHONPATH&#39;</span> )</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        self.<a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stats_loader.html#a2f9e43fe197653f83fa0e15c676eec48">location_rows</a> = self.rows.copy()</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <span class="keywordflow">for</span> child <span class="keywordflow">in</span> self.rows.values():</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;            current = directories.get( child.directory )</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;            directory, filename = child.directory, child.filename</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;            <span class="keywordflow">if</span> current <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                <span class="keywordflow">if</span> directory == <span class="stringliteral">&#39;&#39;</span>:</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                    current = root</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                <span class="keywordflow">else</span>:</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                    current = <a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_location.html">PStatLocation</a>( directory, <span class="stringliteral">&#39;&#39;</span> )</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                    self.<a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stats_loader.html#a2f9e43fe197653f83fa0e15c676eec48">location_rows</a>[ current.key ] = current</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                directories[ directory ] = current</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;            <span class="keywordflow">if</span> filename == <span class="stringliteral">&#39;~&#39;</span>:</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                filename = <span class="stringliteral">&#39;&lt;built-in&gt;&#39;</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;            file_current = files.get( (directory,filename) )</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;            <span class="keywordflow">if</span> file_current <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                file_current = <a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_location.html">PStatLocation</a>( directory, filename )</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                self.<a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stats_loader.html#a2f9e43fe197653f83fa0e15c676eec48">location_rows</a>[ file_current.key ] = file_current</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                files[ (directory,filename) ] = file_current</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                current.children.append( file_current )</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;            file_current.children.append( child )</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <span class="comment"># now link the directories...</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <span class="keywordflow">for</span> key,value <span class="keywordflow">in</span> directories.items():</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            <span class="keywordflow">if</span> value <span class="keywordflow">is</span> root:</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                <span class="keywordflow">continue</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;            found = <span class="keyword">False</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;            <span class="keywordflow">while</span> key:</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                new_key,rest = os.path.split( key )</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                <span class="keywordflow">if</span> new_key == key:</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                    <span class="keywordflow">break</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                key = new_key</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                parent = directories.get( key )</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                <span class="keywordflow">if</span> parent:</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                    <span class="keywordflow">if</span> value <span class="keywordflow">is</span> <span class="keywordflow">not</span> parent:</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                        parent.children.append( value )</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                        found = <span class="keyword">True</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                        <span class="keywordflow">break</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;            <span class="keywordflow">if</span> <span class="keywordflow">not</span> found:</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                root.children.append( value )</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <span class="comment"># lastly, finalize all of the directory records...</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        root.finalize()</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="keywordflow">return</span> root</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div>
<div class="line"><a name="l00107"></a><span class="lineno"><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_base_stat.html">  107</a></span>&#160;<span class="keyword">class </span><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_base_stat.html">BaseStat</a>( object ):</div>
<div class="line"><a name="l00108"></a><span class="lineno"><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_base_stat.html#af54cf1439d01a2b6fe8d43c8ff784d76">  108</a></span>&#160;    <span class="keyword">def </span><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_base_stat.html#af54cf1439d01a2b6fe8d43c8ff784d76">recursive_distinct</a>( self, already_done=None, attribute=&#39;children&#39; ):</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <span class="keywordflow">if</span> already_done <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            already_done = {}</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <span class="keywordflow">for</span> child <span class="keywordflow">in</span> getattr(self,attribute,()):</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            <span class="keywordflow">if</span> <span class="keywordflow">not</span> already_done.has_key( child ):</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                already_done[child] = <span class="keyword">True</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                <span class="keywordflow">yield</span> child</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                <span class="keywordflow">for</span> descendent <span class="keywordflow">in</span> child.recursive_distinct( already_done=already_done, attribute=attribute ):</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                    <span class="keywordflow">yield</span> descendent</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div>
<div class="line"><a name="l00118"></a><span class="lineno"><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_base_stat.html#a9d6d819773db7c0b9d8d9e6ab6e31bc8">  118</a></span>&#160;    <span class="keyword">def </span><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_base_stat.html#a9d6d819773db7c0b9d8d9e6ab6e31bc8">descendants</a>( self ):</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <span class="keywordflow">return</span> list( self.<a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_base_stat.html#af54cf1439d01a2b6fe8d43c8ff784d76">recursive_distinct</a>( attribute=<span class="stringliteral">&#39;children&#39;</span> ))</div>
<div class="line"><a name="l00120"></a><span class="lineno"><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_base_stat.html#a61e4fb2eb02a095b7aa0d8a64a9c3550">  120</a></span>&#160;    <span class="keyword">def </span><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_base_stat.html#a61e4fb2eb02a095b7aa0d8a64a9c3550">ancestors</a>( self ):</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <span class="keywordflow">return</span> list( self.<a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_base_stat.html#af54cf1439d01a2b6fe8d43c8ff784d76">recursive_distinct</a>( attribute=<span class="stringliteral">&#39;parents&#39;</span> ))</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div>
<div class="line"><a name="l00123"></a><span class="lineno"><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_row.html">  123</a></span>&#160;<span class="keyword">class </span><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_row.html">PStatRow</a>( <a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_base_stat.html">BaseStat</a> ):</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;Simulates a HotShot profiler record using PStats module&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00125"></a><span class="lineno"><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_row.html#a711b3f0dd1b2ce5f03c8ac2b855c7c87">  125</a></span>&#160;    <span class="keyword">def </span><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_row.html#a711b3f0dd1b2ce5f03c8ac2b855c7c87">__init__</a>( self, key, raw ):</div>
<div class="line"><a name="l00126"></a><span class="lineno"><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_row.html#af4023649bfb02934012b0da95a0ef7ca">  126</a></span>&#160;        self.<a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_row.html#af4023649bfb02934012b0da95a0ef7ca">children</a> = []</div>
<div class="line"><a name="l00127"></a><span class="lineno"><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_row.html#af587107edfe9bd005be06d807578ac2b">  127</a></span>&#160;        self.<a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_row.html#af587107edfe9bd005be06d807578ac2b">parents</a> = []</div>
<div class="line"><a name="l00128"></a><span class="lineno"><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_row.html#a1ebb611a030a79fa5ef03afcd459a4da">  128</a></span>&#160;        file,line,func = self.<a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_row.html#a1ebb611a030a79fa5ef03afcd459a4da">key</a> = key</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <span class="keywordflow">try</span>:</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            dirname,basename = os.path.dirname(file),os.path.basename(file)</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        <span class="keywordflow">except</span> ValueError, err:</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            dirname = <span class="stringliteral">&#39;&#39;</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            basename = file</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        nc, cc, tt, ct, callers = raw</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <span class="keywordflow">if</span> nc == cc == tt == ct == 0:</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            <span class="keywordflow">raise</span> ValueError( <span class="stringliteral">&#39;Null stats row&#39;</span> )</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        (</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            self.calls, self.recursive, self.local, self.localPer,</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            self.cummulative, self.cummulativePer, self.directory,</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            self.filename, self.name, self.lineno</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        ) = (</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            nc,</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            cc,</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;            tt,</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            tt/(cc <span class="keywordflow">or</span> 0.00000000000001),</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            ct,</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            ct/(nc <span class="keywordflow">or</span> 0.00000000000001),</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;            dirname,</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;            basename,</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            func,</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            line,</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        )</div>
<div class="line"><a name="l00153"></a><span class="lineno"><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_row.html#a499413b4f1ee0bd21d54251e19acd42d">  153</a></span>&#160;        self.<a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_row.html#a499413b4f1ee0bd21d54251e19acd42d">callers</a> = callers</div>
<div class="line"><a name="l00154"></a><span class="lineno"><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_row.html#a5f5e40ef43205cb59d69b62736ef8fc1">  154</a></span>&#160;    <span class="keyword">def </span><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_row.html#a5f5e40ef43205cb59d69b62736ef8fc1">__repr__</a>( self ):</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="keywordflow">return</span> <span class="stringliteral">&#39;PStatRow( %r,%r,%r,%r, %s )&#39;</span>%(self.directory, self.filename, self.lineno, self.name, len(self.<a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_row.html#af4023649bfb02934012b0da95a0ef7ca">children</a>))</div>
<div class="line"><a name="l00156"></a><span class="lineno"><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_row.html#ae2b1d219f78cb14c80538c68ae3fecea">  156</a></span>&#160;    <span class="keyword">def </span><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_row.html#ae2b1d219f78cb14c80538c68ae3fecea">add_child</a>( self, child ):</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        self.children.append( child )</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div>
<div class="line"><a name="l00159"></a><span class="lineno"><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_row.html#a01c4fbff52d890c555f6c9041c3d4ef8">  159</a></span>&#160;    <span class="keyword">def </span><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_row.html#a01c4fbff52d890c555f6c9041c3d4ef8">weave</a>( self, rows ):</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <span class="keywordflow">for</span> caller,data <span class="keywordflow">in</span> self.callers.iteritems():</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            <span class="comment"># data is (cc,nc,tt,ct)</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            parent = rows.get( caller )</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            <span class="keywordflow">if</span> parent:</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                self.parents.append( parent )</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                parent.children.append( self )</div>
<div class="line"><a name="l00166"></a><span class="lineno"><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_row.html#ae3e236d715114e63f11d6fcc5d2cc0da">  166</a></span>&#160;    <span class="keyword">def </span><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_row.html#ae3e236d715114e63f11d6fcc5d2cc0da">child_cumulative_time</a>( self, child ):</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        total = self.cummulative</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <span class="keywordflow">if</span> total:</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            <span class="keywordflow">try</span>:</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                (cc,nc,tt,ct) = child.callers[ self.<a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_row.html#a1ebb611a030a79fa5ef03afcd459a4da">key</a> ]</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            <span class="keywordflow">except</span> TypeError, err:</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                ct = child.callers[ self.<a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_row.html#a1ebb611a030a79fa5ef03afcd459a4da">key</a> ]</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            <span class="keywordflow">return</span> float(ct)/total</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="keywordflow">return</span> 0</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div>
<div class="line"><a name="l00178"></a><span class="lineno"><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_group.html">  178</a></span>&#160;<span class="keyword">class </span><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_group.html">PStatGroup</a>( <a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_base_stat.html">BaseStat</a> ):</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;A node/record that holds a group of children but isn&#39;t a raw-record based group&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="comment"># if LOCAL_ONLY then only take the raw-record&#39;s local values, not cummulative values</span></div>
<div class="line"><a name="l00181"></a><span class="lineno"><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_group.html#a6a5296574b4567ab86e8a64edb29d650">  181</a></span>&#160;    LOCAL_ONLY = <span class="keyword">False</span></div>
<div class="line"><a name="l00182"></a><span class="lineno"><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_group.html#aadd603382f0fec5097563e0bc1068372">  182</a></span>&#160;    <span class="keyword">def </span><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_group.html#aadd603382f0fec5097563e0bc1068372">__init__</a>( self, directory=&#39;&#39;, filename=&#39;&#39;, name=&#39;&#39;, children=None, local_children=None, tree=TREE_CALLS ):</div>
<div class="line"><a name="l00183"></a><span class="lineno"><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_group.html#a6fa000d9de580ba9351995764373d0a2">  183</a></span>&#160;        self.<a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_group.html#a6fa000d9de580ba9351995764373d0a2">directory</a> = directory</div>
<div class="line"><a name="l00184"></a><span class="lineno"><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_group.html#aa7d4db1cfb343aff4d6b879a294a65e8">  184</a></span>&#160;        self.<a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_group.html#aa7d4db1cfb343aff4d6b879a294a65e8">filename</a> = filename</div>
<div class="line"><a name="l00185"></a><span class="lineno"><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_group.html#aeacce454682034a6ea5b13f2fcd13464">  185</a></span>&#160;        self.<a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_group.html#aeacce454682034a6ea5b13f2fcd13464">name</a> = <span class="stringliteral">&#39;&#39;</span></div>
<div class="line"><a name="l00186"></a><span class="lineno"><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_group.html#acbe83d78897ce4322e2374eee5488b9c">  186</a></span>&#160;        self.<a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_group.html#acbe83d78897ce4322e2374eee5488b9c">key</a> = (directory,filename,name)</div>
<div class="line"><a name="l00187"></a><span class="lineno"><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_group.html#a7aec37d183797dd1efe757c603a4be91">  187</a></span>&#160;        self.<a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_group.html#a7aec37d183797dd1efe757c603a4be91">children</a> = children <span class="keywordflow">or</span> []</div>
<div class="line"><a name="l00188"></a><span class="lineno"><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_group.html#a18755b56bff8c8ddd310140f3589e5f2">  188</a></span>&#160;        self.<a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_group.html#a18755b56bff8c8ddd310140f3589e5f2">parents</a> = []</div>
<div class="line"><a name="l00189"></a><span class="lineno"><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_group.html#a47c4083d7a2e9cb4c28c7b08f75b2e9b">  189</a></span>&#160;        self.<a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_group.html#a47c4083d7a2e9cb4c28c7b08f75b2e9b">local_children</a> = local_children <span class="keywordflow">or</span> []</div>
<div class="line"><a name="l00190"></a><span class="lineno"><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_group.html#ab83e831964dda55751e41d9a90092a6c">  190</a></span>&#160;        self.<a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_group.html#ab83e831964dda55751e41d9a90092a6c">tree</a> = tree</div>
<div class="line"><a name="l00191"></a><span class="lineno"><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_group.html#a8531a1b9fef0c63360ca49825cfe9206">  191</a></span>&#160;    <span class="keyword">def </span><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_group.html#a8531a1b9fef0c63360ca49825cfe9206">__repr__</a>( self ):</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <span class="keywordflow">return</span> <span class="stringliteral">&#39;%s( %r,%r,%s )&#39;</span>%(self.__class__.__name__,self.<a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_group.html#a6fa000d9de580ba9351995764373d0a2">directory</a>, self.<a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_group.html#aa7d4db1cfb343aff4d6b879a294a65e8">filename</a>, self.<a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_group.html#aeacce454682034a6ea5b13f2fcd13464">name</a>)</div>
<div class="line"><a name="l00193"></a><span class="lineno"><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_group.html#a617b112cb2c028cba76d684cba4912a2">  193</a></span>&#160;    <span class="keyword">def </span><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_group.html#a617b112cb2c028cba76d684cba4912a2">finalize</a>( self, already_done=None ):</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;Finalize our values (recursively) taken from our children&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        <span class="keywordflow">if</span> already_done <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            already_done = {}</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <span class="keywordflow">if</span> already_done.has_key( self ):</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">True</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        already_done[self] = <span class="keyword">True</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        self.<a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_group.html#a0ba8190d65f9e75a10e2a85049eb3e5a">filter_children</a>()</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        children = self.<a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_group.html#a7aec37d183797dd1efe757c603a4be91">children</a></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <span class="keywordflow">for</span> child <span class="keywordflow">in</span> children:</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            <span class="keywordflow">if</span> hasattr( child, <span class="stringliteral">&#39;finalize&#39;</span> ):</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                child.finalize( already_done)</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;            child.parents.append( self )</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        self.<a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_group.html#a295eb19dbfae9022342632d08f70f14e">calculate_totals</a>( self.<a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_group.html#a7aec37d183797dd1efe757c603a4be91">children</a>, self.<a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_group.html#a47c4083d7a2e9cb4c28c7b08f75b2e9b">local_children</a> )</div>
<div class="line"><a name="l00207"></a><span class="lineno"><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_group.html#a0ba8190d65f9e75a10e2a85049eb3e5a">  207</a></span>&#160;    <span class="keyword">def </span><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_group.html#a0ba8190d65f9e75a10e2a85049eb3e5a">filter_children</a>( self ):</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;Filter our children into regular and local children sets (if appropriate)&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00209"></a><span class="lineno"><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_group.html#a295eb19dbfae9022342632d08f70f14e">  209</a></span>&#160;    <span class="keyword">def </span><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_group.html#a295eb19dbfae9022342632d08f70f14e">calculate_totals</a>( self, children, local_children=None ):</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;Calculate our cummulative totals from children and/or local children&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        <span class="keywordflow">for</span> field,local_field <span class="keywordflow">in</span> ((<span class="stringliteral">&#39;recursive&#39;</span>,<span class="stringliteral">&#39;calls&#39;</span>),(<span class="stringliteral">&#39;cummulative&#39;</span>,<span class="stringliteral">&#39;local&#39;</span>)):</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            values = []</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            <span class="keywordflow">for</span> child <span class="keywordflow">in</span> children:</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                <span class="keywordflow">if</span> isinstance( child, PStatGroup ) <span class="keywordflow">or</span> <span class="keywordflow">not</span> self.LOCAL_ONLY:</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                    values.append( getattr( child, field, 0 ) )</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                <span class="keywordflow">elif</span> isinstance( child, PStatRow ) <span class="keywordflow">and</span> self.LOCAL_ONLY:</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                    values.append( getattr( child, local_field, 0 ) )</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            value = sum( values )</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            setattr( self, field, value )</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        <span class="keywordflow">if</span> self.recursive:</div>
<div class="line"><a name="l00221"></a><span class="lineno"><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_group.html#abb1dae5bbbfb3f14a2624ea628a85b29">  221</a></span>&#160;            self.<a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_group.html#abb1dae5bbbfb3f14a2624ea628a85b29">cummulativePer</a> = self.cummulative/float(self.<a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_group.html#a3ceb2a8e8cb93e9c1bd63257e5fb7ff4">recursive</a>)</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <span class="keywordflow">else</span>:</div>
<div class="line"><a name="l00223"></a><span class="lineno"><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_group.html#a3ceb2a8e8cb93e9c1bd63257e5fb7ff4">  223</a></span>&#160;            self.<a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_group.html#a3ceb2a8e8cb93e9c1bd63257e5fb7ff4">recursive</a> = 0</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        <span class="keywordflow">if</span> local_children:</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;            <span class="keywordflow">for</span> field <span class="keywordflow">in</span> (<span class="stringliteral">&#39;local&#39;</span>,<span class="stringliteral">&#39;calls&#39;</span>):</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                value = sum([ getattr( child, field, 0 ) <span class="keywordflow">for</span> child <span class="keywordflow">in</span> children] )</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                setattr( self, field, value )</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            <span class="keywordflow">if</span> self.<a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_group.html#a08fe18287cf931c61bd9f5cc2531bdff">calls</a>:</div>
<div class="line"><a name="l00229"></a><span class="lineno"><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_group.html#a09d3b5b8e6b565c4f3589878dd9592cb">  229</a></span>&#160;                self.<a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_group.html#a09d3b5b8e6b565c4f3589878dd9592cb">localPer</a> = self.<a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_group.html#adb1fdca541f65cca96506711b542ec1a">local</a> / self.<a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_group.html#a08fe18287cf931c61bd9f5cc2531bdff">calls</a></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <span class="keywordflow">else</span>:</div>
<div class="line"><a name="l00231"></a><span class="lineno"><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_group.html#adb1fdca541f65cca96506711b542ec1a">  231</a></span>&#160;            self.<a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_group.html#adb1fdca541f65cca96506711b542ec1a">local</a> = 0</div>
<div class="line"><a name="l00232"></a><span class="lineno"><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_group.html#a08fe18287cf931c61bd9f5cc2531bdff">  232</a></span>&#160;            self.<a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_group.html#a08fe18287cf931c61bd9f5cc2531bdff">calls</a> = 0</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            self.<a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_group.html#a09d3b5b8e6b565c4f3589878dd9592cb">localPer</a> = 0</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div>
<div class="line"><a name="l00236"></a><span class="lineno"><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_location.html">  236</a></span>&#160;<span class="keyword">class </span><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_location.html">PStatLocation</a>( <a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_group.html">PStatGroup</a> ):</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;A row that represents a hierarchic structure other than call-patterns</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="stringliteral">    This is used to create a file-based hierarchy for the views</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="stringliteral">    Children with the name &lt;module&gt; are our &quot;empty&quot; space,</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="stringliteral">    our totals are otherwise just the sum of our children.</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00244"></a><span class="lineno"><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_location.html#ac8d84a15a580a4d6eb9a02504e04ec8c">  244</a></span>&#160;    LOCAL_ONLY = <span class="keyword">True</span></div>
<div class="line"><a name="l00245"></a><span class="lineno"><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_location.html#af3b35a449a9e0dc598f393c1323608bb">  245</a></span>&#160;    <span class="keyword">def </span><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_location.html#af3b35a449a9e0dc598f393c1323608bb">__init__</a>( self, directory, filename, tree=TREE_FILES):</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        super( PStatLocation, self ).<a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_location.html#af3b35a449a9e0dc598f393c1323608bb">__init__</a>( directory=directory, filename=filename, name=<span class="stringliteral">&#39;package&#39;</span>, tree=tree )</div>
<div class="line"><a name="l00247"></a><span class="lineno"><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_location.html#a4e2a65d6150648b23b1210dd38381e98">  247</a></span>&#160;    <span class="keyword">def </span><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_location.html#a4e2a65d6150648b23b1210dd38381e98">filter_children</a>( self ):</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;Filter our children into regular and local children sets&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        real_children = []</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        <span class="keywordflow">for</span> child <span class="keywordflow">in</span> self.<a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_group.html#a7aec37d183797dd1efe757c603a4be91">children</a>:</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            <span class="keywordflow">if</span> child.name == <span class="stringliteral">&#39;&lt;module&gt;&#39;</span>:</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                self.local_children.append( child )</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            <span class="keywordflow">else</span>:</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                real_children.append( child )</div>
<div class="line"><a name="l00255"></a><span class="lineno"><a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_location.html#a4069ec065cfcc79b53465cb09b5018a9">  255</a></span>&#160;        self.<a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stat_group.html#a7aec37d183797dd1efe757c603a4be91">children</a> = real_children</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="keywordflow">if</span> __name__ == <span class="stringliteral">&quot;__main__&quot;</span>:</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="keyword">import</span> sys</div>
<div class="line"><a name="l00261"></a><span class="lineno"><a class="code" href="namespaceoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader.html#affd1a3b621b38d9cdee5a59aefa0c400">  261</a></span>&#160;    p = <a class="code" href="classoacs_1_1lib_1_1debug_1_1runsnakerun_1_1pstatsloader_1_1_p_stats_loader.html">PStatsLoader</a>( sys.argv[1] )</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keyword">assert</span> p.tree</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keywordflow">print</span> p.tree</div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_95dea3d10c9f98c1baa90e87e0175c9f.html">oacs</a></li><li class="navelem"><a class="el" href="dir_3841315bfd9ffd1d6ca7b95fc4faf1e8.html">oacs</a></li><li class="navelem"><a class="el" href="dir_21b84646a66e1b24a785a648bc86a4ce.html">oacs</a></li><li class="navelem"><a class="el" href="dir_f4012c60f4aa39009a0bf5e65219707c.html">lib</a></li><li class="navelem"><a class="el" href="dir_d66e356242a504b5c79398ecabd69f96.html">debug</a></li><li class="navelem"><a class="el" href="dir_a6428b578baafd31ed97d99cc639ded3.html">runsnakerun</a></li><li class="navelem"><a class="el" href="pstatsloader_8py.html">pstatsloader.py</a></li>
    <li class="footer">Generated on Thu May 9 2013 17:43:10 for OACS by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.3.1 </li>
  </ul>
</div>
</body>
</html>
